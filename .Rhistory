theme(axis.text.x = element_text(hjust=1)) +
labs(title="Yield (yld_h) / treatment", x="NBLS", y="yld_h")
p_yldh_trt_env
p_yldh_trt_stage <- ggplot(CERC_PROTH_data, aes(CBP, yld_h)) +
geom_boxplot(outlier.alpha = 0.15) +
geom_jitter(width = 0.15, alpha = 0.25) +
facet_grid(stage ~ env, scales = "free_y") +
theme(axis.text.x = element_text(hjust=1)) +
labs(title="yld_h / treatment / CBP", x="CBP", y="yld_h")
p_yldh_trt_stage
View(CERC_PROTH_data)
p_yldh_trt_stage <- ggplot(CERC_PROTH_data, aes(CPB, yld_h)) +
geom_boxplot(outlier.alpha = 0.15) +
geom_jitter(width = 0.15, alpha = 0.25) +
facet_grid(stage ~ env, scales = "free_y") +
theme(axis.text.x = element_text(hjust=1)) +
labs(title="yld_h / treatment / CPB", x="CBP", y="yld_h")
p_yldh_trt_stage
View(CERC_PROTH_data)
p_total_trt <- ggplot(CERC_PROTH_data, aes(trt, total)) +
geom_boxplot(outlier.alpha = 0.15) +
geom_jitter(width=0.15, alpha=0.25) +
facet_wrap(~ env, scales="free_y") +
theme(axis.text.x = element_text(hjust=1)) +
labs(title="Total (%) / treatment", x="trt", y="total")
p_head_trt <- ggplot(CERC_PROTH_data, aes(trt, head)) +
geom_boxplot(outlier.alpha = 0.15) +
geom_jitter(width=0.15, alpha=0.25) +
facet_wrap(~ env, scales="free_y") +
theme(axis.text.x = element_text(hjust=1)) +
labs(title="Head (%) / treatment", x="trt", y="head")
p_total_trt / p_head_trt
p_total_CPB <- ggplot(CERC_PROTH_data, aes(CPB, total)) +
geom_boxplot(outlier.alpha = 0.15) +
geom_jitter(width=0.15, alpha=0.25) +
facet_wrap(~ env, scales="free_y") +
theme(axis.text.x = element_text(hjust=1)) +
labs(title="Total (%) / CPB", x="CPB", y="total")
p_head_CPB <- ggplot(CERC_PROTH_data, aes(CPB, head)) +
geom_boxplot(outlier.alpha = 0.15) +
geom_jitter(width=0.15, alpha=0.25) +
facet_wrap(~ env, scales="free_y") +
theme(axis.text.x = element_text(hjust=1)) +
labs(title="Head (%) / CPB", x="CPB", y="head")
p_total_CPB / p_head_CPB
p_yldh_trt_env <- ggplot(CERC_PROTH_data, aes(NBLS, yld_h)) +
geom_boxplot(outlier.alpha = 0.15) +
geom_jitter(width = 0.15, alpha = 0.25) +
facet_wrap(~ env, scales = "free_y") +
theme(axis.text.x = element_text(hjust=1)) +
labs(title="Yield (yld_h) / NBLS", x="NBLS", y="yld_h")
p_yldh_trt_env
p_yldh_cpb <- ggplot(df, aes(CERC_PROTH_data, yld_h)) +
geom_point(alpha=0.35) +
geom_smooth(method="lm", se=FALSE) +
facet_wrap(~ env) +
labs(title="yld_h vs CPB (enviroment)", x="CPB", y="yld_h")
p_yldh_nbls <- ggplot(CERC_PROTH_dataf, aes(NBLS, yld_h)) +
geom_point(alpha=0.35) +
geom_smooth(method="lm", se=FALSE) +
facet_wrap(~ env) +
labs(title="yld_h vs NBLS (enviroment)", x="NBLS", y="yld_h")
p_yldh_nbls <- ggplot(CERC_PROTH_data, aes(NBLS, yld_h)) +
geom_point(alpha=0.35) +
geom_smooth(method="lm", se=FALSE) +
facet_wrap(~ env) +
labs(title="yld_h vs NBLS (enviroment)", x="NBLS", y="yld_h")
p_yldh_NBLS
p_yldh_CPB <- ggplot(df, aes(CERC_PROTH_data, yld_h)) +
geom_point(alpha=0.35) +
geom_smooth(method="lm", se=FALSE) +
facet_wrap(~ env) +
labs(title="yld_h vs CPB (enviroment)", x="CPB", y="yld_h")
p_yldh_CPB <- ggplot(CERC_PROTH_data, aes(CPB, yld_h)) +
geom_point(alpha=0.35) +
geom_smooth(method="lm", se=FALSE) +
facet_wrap(~ env) +
labs(title="yld_h vs CPB (enviroment)", x="CPB", y="yld_h")
p_yldh_CPB
p_yldh_NBLS <- ggplot(CERC_PROTH_data, aes(NBLS, yld_h)) +
geom_point(alpha=0.35) +
geom_smooth(method="lm", se=FALSE) +
facet_wrap(~ env) +
labs(title="yld_h vs NBLS (enviroment)", x="NBLS", y="yld_h")
p_yldh_NBLS
p_yldh_CPB <- ggplot(CERC_PROTH_data, aes(CPB, yld_h)) +
geom_point(alpha=0.35) +
geom_smooth(method="lm", se=FALSE) +
facet_wrap(~ env) +
labs(title="yld_h vs CPB (enviroment)", x="CPB", y="yld_h")
p_yldh_NBLS <- ggplot(CERC_PROTH_data, aes(NBLS, yld_h)) +
geom_point(alpha=0.35) +
geom_smooth(method="lm", se=FALSE) +
facet_wrap(~ env) +
labs(title="yld_h vs NBLS (enviroment)", x="NBLS", y="yld_h")
p_yldh_CPB / p_yldh_NBLS
p_yldh_trt_env <- ggplot(CERC_PROTH_data, aes(trt, yld_h)) +
geom_boxplot(outlier.alpha = 0.15) +
geom_jitter(width = 0.15, alpha = 0.25) +
facet_wrap(~ env, scales = "free_y") +
theme(axis.text.x = element_text(hjust=1)) +
labs(title="Yield (yld_h) / treatment", x="trt", y="yld_h")
p_yldh_trt_env
p_yldh_trt_env <- ggplot(CERC_PROTH_data, aes(NBLS, yld_h)) +
geom_boxplot(outlier.alpha = 0.15) +
geom_jitter(width = 0.15, alpha = 0.25) +
facet_wrap(~ env, scales = "free_y") +
theme(axis.text.x = element_text(hjust=1)) +
labs(title="Yield (yld_h) / NBLS", x="NBLS", y="yld_h")
p_yldh_trt_env
p_yldh_NBLS_env <- ggplot(CERC_PROTH_data, aes(NBLS, yld_h)) +
geom_boxplot(outlier.alpha = 0.15) +
geom_jitter(width = 0.15, alpha = 0.25) +
facet_wrap(~ env, scales = "free_y") +
theme(axis.text.x = element_text(hjust=1)) +
labs(title="Yield (yld_h) / NBLS", x="NBLS", y="yld_h")
p_yldh_CPB_env <- ggplot(CERC_PROTH_data, aes(CPB, yld_h)) +
geom_boxplot(outlier.alpha = 0.15) +
geom_jitter(width = 0.15, alpha = 0.25) +
facet_grid(~ env, scales = "free_y") +
theme(axis.text.x = element_text(hjust=1)) +
labs(title="Yield (yld_h) / CPB", x="CBP", y="yld_h")
p_yldh_NBLS_env / p_yldh_CPB_env
View(CERC_PROTH_data)
p_yldh_nles <- ggplot(CERC_PROTH_data, aes(n_lesion, yld_h)) +
geom_boxplot(outlier.alpha = 0.15) +
geom_jitter(width = 0.15, alpha = 0.25) +
facet_grid(~ env, scales = "free_y") +
theme(axis.text.x = element_text(hjust=1)) +
labs(title="Yield (yld_h) / CPB", x="n_lesion", y="yld_h")
p_yldh_nles
p_yldh_NBLS <- ggplot(CERC_PROTH_data, aes(NBLS, yld_h)) +
geom_boxplot(outlier.alpha = 0.15) +
geom_jitter(width = 0.15, alpha = 0.25) +
facet_wrap(~ env, scales = "free_y") +
theme(axis.text.x = element_text(hjust=1)) +
labs(title="Yield (yld_h) / NBLS", x="NBLS", y="yld_h")
p_yldh_CPB <- ggplot(CERC_PROTH_data, aes(CPB, yld_h)) +
geom_boxplot(outlier.alpha = 0.15) +
geom_jitter(width = 0.15, alpha = 0.25) +
facet_grid(~ env, scales = "free_y") +
theme(axis.text.x = element_text(hjust=1)) +
labs(title="Yield (yld_h) / CPB", x="CBP", y="yld_h")
p_yldh_nles <- ggplot(CERC_PROTH_data, aes(n_lesion, yld_h)) +
geom_boxplot(outlier.alpha = 0.15) +
geom_jitter(width = 0.15, alpha = 0.25) +
facet_grid(~ env, scales = "free_y") +
theme(axis.text.x = element_text(hjust=1)) +
labs(title="Yield (yld_h) / CPB", x="n_lesion", y="yld_h")
p_yldh_NBLS / p_yldh_CPB / p_yldh_nles
p_yldh_NBLS <- ggplot(CERC_PROTH_data, aes(NBLS, yld_h)) +
geom_boxplot(outlier.alpha = 0.15) +
geom_jitter(width = 0.15, alpha = 0.25) +
facet_wrap(~ env, scales = "free_y") +
theme(axis.text.x = element_text(hjust=1)) +
labs(title="Yield / NBLS", x="NBLS", y="yld_h")
p_yldh_CPB <- ggplot(CERC_PROTH_data, aes(CPB, yld_h)) +
geom_boxplot(outlier.alpha = 0.15) +
geom_jitter(width = 0.15, alpha = 0.25) +
facet_grid(~ env, scales = "free_y") +
theme(axis.text.x = element_text(hjust=1)) +
labs(title="Yield / CPB", x="CBP", y="yld_h")
p_yldh_nles <- ggplot(CERC_PROTH_data, aes(n_lesion, yld_h)) +
geom_boxplot(outlier.alpha = 0.15) +
geom_jitter(width = 0.15, alpha = 0.25) +
facet_grid(~ env, scales = "free_y") +
theme(axis.text.x = element_text(hjust=1)) +
labs(title="Yield / Number of Lesion", x="N of lesion", y="yld_h")
p_yldh_NBLS / p_yldh_CPB / p_yldh_nles
p_yldh_NBLS <- ggplot(CERC_PROTH_data, aes(NBLS, yld_h)) +
geom_boxplot(outlier.alpha = 0.15) +
geom_jitter(width = 0.15, alpha = 0.25) +
facet_wrap(~ env, scales = "free_y") +
theme(axis.text.x = element_text(hjust=1)) +
labs(title="Yield / NBLS", x="NBLS", y="yld_h")
p_yldh_CPB <- ggplot(CERC_PROTH_data, aes(CPB, yld_h)) +
geom_boxplot(outlier.alpha = 0.15) +
geom_jitter(width = 0.15, alpha = 0.25) +
facet_grid(~ env, scales = "free_y") +
theme(axis.text.x = element_text(hjust=1)) +
labs(title="Yield / CPB", x="CBP", y="yld_h")
p_yldh_nles <- ggplot(CERC_PROTH_data, aes(n_lesion, yld_h)) +
geom_boxplot(outlier.alpha = 0.15) +
geom_jitter(width = 0.15, alpha = 0.25) +
facet_grid(~ env, scales = "free_y") +
theme(axis.text.x = element_text(hjust=1)) +
labs(title="Yield / Number of Lesion", x="N of lesion", y="yld_h")
p_yldh_NBLS / p_yldh_CPB / p_yldh_nles
p_yldh_CPB <- ggplot(CERC_PROTH_data, aes(CPB, yld_h)) +
geom_point(alpha=0.35) +
geom_smooth(method="lm", se=FALSE) +
facet_wrap(~ env) +
labs(title="yld_h vs CPB (enviroment)", x="CPB", y="yld_h")
p_yldh_NBLS <- ggplot(CERC_PROTH_data, aes(NBLS, yld_h)) +
geom_point(alpha=0.35) +
geom_smooth(method="lm", se=FALSE) +
facet_wrap(~ env) +
labs(title="yld_h vs NBLS (enviroment)", x="NBLS", y="yld_h")
p_yldh_CPB / p_yldh_NBLS
p_yldh_CPB <- ggplot(CERC_PROTH_data, aes(CPB, yld_h)) +
geom_point(alpha=0.35) +
geom_smooth(method="lm", se=FALSE) +
facet_wrap(~ env) +
labs(title="yld_h vs CPB", x="CPB", y="yld_h")
p_yldh_NBLS <- ggplot(CERC_PROTH_data, aes(NBLS, yld_h)) +
geom_point(alpha=0.35) +
geom_smooth(method="lm", se=FALSE) +
facet_wrap(~ env) +
labs(title="yld_h vs NBLS", x="NBLS", y="yld_h")
p_yldh_Nles <- ggplot(CERC_PROTH_data, aes(n_lesion, yld_h)) +
geom_point(alpha=0.35) +
geom_smooth(method="lm", se=FALSE) +
facet_wrap(~ env) +
labs(title="yld_h vs Number of Lesion", x="n_lesion", y="yld_h")
p_yldh_CPB / p_yldh_NBLS / p_yldh_Nles
p_yldh_NBLS <- ggplot(CERC_PROTH_data, aes(NBLS, yld_h)) +
geom_boxplot(outlier.alpha = 0.15) +
geom_jitter(width = 0.15, alpha = 0.25) +
facet_wrap(~ env, scales = "free_y") +
theme(axis.text.x = element_text(hjust=1)) +
labs(title="Yield / NBLS", x="NBLS", y="yld_h")
p_yldh_CPB <- ggplot(CERC_PROTH_data, aes(CPB, yld_h)) +
geom_boxplot(outlier.alpha = 0.15) +
geom_jitter(width = 0.15, alpha = 0.25) +
facet_grid(~ env, scales = "free_y") +
theme(axis.text.x = element_text(hjust=1)) +
labs(title="Yield / CPB", x="CBP", y="yld_h")
p_yldh_Nles <- ggplot(CERC_PROTH_data, aes(n_lesion, yld_h)) +
geom_boxplot(outlier.alpha = 0.15) +
geom_jitter(width = 0.15, alpha = 0.25) +
facet_grid(~ env, scales = "free_y") +
theme(axis.text.x = element_text(hjust=1)) +
labs(title="Yield / Number of Lesion", x="N of lesion", y="yld_h")
p_yldh_NBLS / p_yldh_CPB / p_yldh_Nles
library(tidyverse)
library(lme4)
library(emmeans)
library(ggplot2)
library(car)
library(performance)
library(patchwork)
library(sjPlot)
library(flextable)
library(multcomp)
library(multcompView)
conflicted::conflict_prefer("select", "dplyr")
conflicted::conflict_prefer("filter", "dplyr")
PROTH_data <- readxl::read_xlsx("Data/Cercospora_PROTH_measure.xlsx","PROTH")
PROTH_desc <- readxl::read_xlsx("Data/Cercospora_PROTH_description.xlsx","PROTH")
PROTH_data_disease <-  PROTH_data
PROTH_data_yield   <-  PROTH_desc
n_lesion_plot <- PROTH_data_disease %>%
filter(lesion_n > 0) %>%
group_by(year, trial_ID, plot) %>%
summarise(
CPB = mean(CPB, na.rm = TRUE),
n_lesion = n(),
.groups = "drop",
inc  = (n_lesion * 100)/50)
PROTH_yield_data <- PROTH_data_yield %>%
mutate(
yld_a = weight * ((1-(moist/100))/(1-0.12))*(43560/(4.66*16)),
yld_h = yld_a * 1.12085) %>%
dplyr::select(year, trial_ID, trial, env, field, plot, blk, trt,
gen, stage, rate, total, head, yld_a, yld_h, NBLS)
CERC_PROTH_data <- right_join(PROTH_yield_data, n_lesion_plot,
by = c("year","trial_ID","plot")) %>%
filter(!field %in% c("WIN")) %>%
mutate(
pressure = ifelse(inc > 64, "high", "low"))
ggplot(CERC_PROTH_data, aes(trt, inc)) +
geom_boxplot(outlier.alpha = 0.2) +
geom_jitter(width = 0.15, alpha = 0.3) +
facet_wrap(~ stage) +
theme_bw() +
theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
labs(
title = "Incidence of Cercospora (%) by treatment",
subtitle = "High pressure of the disease",
x = "Treatment",
y = "Incidence (%)"
)
p_CPB_trt <- ggplot(CERC_PROTH_data, aes(trt, CPB)) +
geom_boxplot(outlier.alpha = 0.2) +
geom_jitter(width = 0.15, alpha = 0.25) +
facet_wrap(~ env, scales = "free_y") +
theme_bw() +
theme(axis.text.x = element_text(angle=45, hjust=1)) +
labs(title="CPB per treatment (Environment)", x="trt", y="CPB")
p_inc_trt <- ggplot(CERC_PROTH_data, aes(trt, inc)) +
geom_boxplot(outlier.alpha = 0.2) +
geom_jitter(width = 0.15, alpha = 0.25) +
facet_wrap(~ env, scales = "free_y") +
theme_bw() +
theme(axis.text.x = element_text(angle=45, hjust=1)) +
labs(title="Incidence by treatment (Environment)", x="trt", y="inc")
p_press_CPB <- ggplot(CERC_PROTH_data, aes(pressure, CPB, color = trt)) +
geom_point(alpha = 0.35) +
geom_smooth(method="lm", se=FALSE) +
facet_wrap(~ env) +
theme_bw() +
labs(title="Pressure × CPB (trt)", x="pressure", y="CPB")
(p_CPB_trt / p_inc_trt / p_press_CPB)
p_NBLS_trt <- ggplot(CERC_PROTH_data, aes(trt, NBLS)) +
geom_boxplot(outlier.alpha = 0.2) +
geom_jitter(width = 0.15, alpha = 0.25) +
facet_wrap(~ env, scales = "free_y") +
theme_bw() +
theme(axis.text.x = element_text(angle=45, hjust=1)) +
labs(title="NBLS per treatment (Environment)", x="trt", y="NBLS")
p_inc_trt <- ggplot(CERC_PROTH_data, aes(trt, inc)) +
geom_boxplot(outlier.alpha = 0.2) +
geom_jitter(width = 0.15, alpha = 0.25) +
facet_wrap(~ env, scales = "free_y") +
theme_bw() +
theme(axis.text.x = element_text(angle=45, hjust=1)) +
labs(title="Incidence by treatment (Environment)", x="trt", y="inc")
p_press_NBLS <- ggplot(CERC_PROTH_data, aes(pressure, NBLS, color = trt)) +
geom_point(alpha = 0.35) +
geom_smooth(method="lm", se=FALSE) +
facet_wrap(~ env) +
theme_bw() +
labs(title="Pressure × NBLS (trt)", x="pressure", y="NBLS")
(p_NBLS_trt / p_inc_trt / p_press_NBLS)
c_inc <- lmer(
inc ~ trt * stage + gen + pressure +
(1 | env) + (1 | env:blk),
data = CERC_PROTH_data
)
anova(c_inc)
summary(c_inc)
check_model(c_inc)
c_CPB <- lmer(
CPB ~ trt * stage + gen + pressure +
(1 | env) + (1 | env:blk),
data = CERC_PROTH_data
)
anova(c_CPB)
summary(c_CPB)
check_model(c_CPB)
c_NBLS <- lmer(
NBLS ~ trt * stage + gen + pressure +
(1 | env) + (1 | env:blk),
data = CERC_PROTH_data
)
anova(c_NBLS)
summary(c_NBLS)
check_model(c_NBLS)
ggplot(CERC_PROTH_data, aes(trt, fill = as.factor(NBLS))) +
geom_bar(position = "fill") +
facet_wrap(~ env) +
theme_bw() +
labs(
y = "plot ratio",
fill = "NBLS",
title = "Occurrence of NBLS by treatment"
)
ggplot(CERC_PROTH_data, aes(trt, NBLS)) +
geom_boxplot(outlier.alpha = 0.2) +
geom_jitter(width = 0.15, alpha = 0.3) +
facet_wrap(~ stage) +
theme_bw() +
theme(axis.text.x = element_text(hjust=1)) +
labs(
title = "NBLS severity by treatmento",
x = "Treatment",
y = "NBLS score"
)
c_nles <- lmer(
n_lesion ~ trt * stage + gen + pressure +
(1 | env) + (1 | env:blk),
data = CERC_PROTH_data
)
anova(c_nles)
summary(c_nles)
check_model(c_nles)
c_yld_disease <- lmer(
yld_h ~ NBLS + CPB + n_lesion + inc + gen + pressure +
(1 | env) + (1 | env:blk),
data = CERC_PROTH_data
)
anova(c_yld_disease)
summary(c_yld_disease)
check_model(c_yld_disease)
p_yldh_trt_env <- ggplot(CERC_PROTH_data, aes(trt, yld_h)) +
geom_boxplot(outlier.alpha = 0.15) +
geom_jitter(width = 0.15, alpha = 0.25) +
facet_wrap(~ env, scales = "free_y") +
theme(axis.text.x = element_text(hjust=1)) +
labs(title="Yield (yld_h) / treatment", x="trt", y="yld_h")
p_yldh_trt_env
p_yldh_trt_stage <- ggplot(CERC_PROTH_data, aes(trt, yld_h)) +
geom_boxplot(outlier.alpha = 0.15) +
geom_jitter(width = 0.15, alpha = 0.25) +
facet_grid(stage ~ env, scales = "free_y") +
theme(axis.text.x = element_text(hjust=1)) +
labs(title="yld_h / treatment, separated by stage and environment", x="trt", y="yld_h")
p_yldh_trt_stage
p_yldh_NBLS <- ggplot(CERC_PROTH_data, aes(NBLS, yld_h)) +
geom_boxplot(outlier.alpha = 0.15) +
geom_jitter(width = 0.15, alpha = 0.25) +
facet_wrap(~ env, scales = "free_y") +
theme(axis.text.x = element_text(hjust=1)) +
labs(title="Yield / NBLS", x="NBLS", y="yld_h")
p_yldh_CPB <- ggplot(CERC_PROTH_data, aes(CPB, yld_h)) +
geom_boxplot(outlier.alpha = 0.15) +
geom_jitter(width = 0.15, alpha = 0.25) +
facet_grid(~ env, scales = "free_y") +
theme(axis.text.x = element_text(hjust=1)) +
labs(title="Yield / CPB", x="CBP", y="yld_h")
p_yldh_Nles <- ggplot(CERC_PROTH_data, aes(n_lesion, yld_h)) +
geom_boxplot(outlier.alpha = 0.15) +
geom_jitter(width = 0.15, alpha = 0.25) +
facet_grid(~ env, scales = "free_y") +
theme(axis.text.x = element_text(hjust=1)) +
labs(title="Yield / Number of Lesion", x="N of lesion", y="yld_h")
p_yldh_NBLS / p_yldh_CPB / p_yldh_Nles
library(tidyverse)
library(lme4)
library(emmeans)
library(ggplot2)
library(car)
library(performance)
library(patchwork)
library(sjPlot)
library(flextable)
library(multcomp)
library(multcompView)
conflicted::conflict_prefer("select", "dplyr")
conflicted::conflict_prefer("filter", "dplyr")
PROTH_data <- readxl::read_xlsx("CERC_Data_PROTH/Cercospora_PROTH_measure.xlsx","PROTH")
PROTH_data <- readxl::read_xlsx("Data/Cercospora_PROTH_measure.xlsx","PROTH")
PROTH_desc <- readxl::read_xlsx("Data/Cercospora_PROTH_description.xlsx", "PROTH")
library(tidyverse)
library(lme4)
library(emmeans)
library(ggplot2)
library(car)
library(performance)
library(patchwork)
library(sjPlot)
library(flextable)
library(multcomp)
library(multcompView)
conflicted::conflict_prefer("select", "dplyr")
conflicted::conflict_prefer("filter", "dplyr")
PROTH_data <- readxl::read_xlsx("Data/Cercospora_PROTH_measure.xlsx","PROTH")
PROTH_desc <- readxl::read_xlsx("Data/Cercospora_PROTH_description.xlsx", "PROTH")
PROTH_data_disease <-  PROTH_data
PROTH_data_yield   <-  PROTH_desc
n_lesion_plot <- PROTH_data_disease %>%
filter(lesion_n > 0) %>%
group_by(year, trial_ID, plot) %>%
summarise(
CPB = mean(CPB, na.rm = TRUE),
n_lesion = n(),
.groups = "drop",
inc  = (n_lesion * 100)/50)
PROTH_yield_data <- PROTH_data_yield %>%
mutate(
yld = weight_12/(80/43560),
kg_ha = yld*1.2085) %>%
dplyr::select(year, trial_ID, trial, env, field, plot, blk, trt,
gen, fung, stage, rate, total, head, yld, kg_ha, NBLS)
CERC_PROTH_data <- right_join(PROTH_yield_data, n_lesion_plot,
by = c("year","trial_ID","plot")) %>%
filter(!field %in% c("WIN")) %>%
mutate(
pressure = ifelse(inc > median(inc), "high", "low"))
CERC_PROTH_data
# Produtividade
ggplot(CERC_PROTH_data, aes(x = rate, y = kg_ha, color = trt)) +
geom_boxplot() +
geom_point(size=2) +
geom_smooth(method = "lm", se = FALSE) +
theme_bw() +
facet_wrap(~env)
# Produtividade X Rate (BLK)
ggplot(CERC_PROTH_data, aes(x = rate, y = kg_ha, color = trt)) +
geom_boxplot() +
geom_point(size=2) +
geom_smooth(method = "lm", se = FALSE) +
theme_bw() +
facet_wrap(~blk)
# Relação entre CPB e produtividade
ggplot(CERC_PROTH_data, aes(x = CPB, y = kg_ha, group = stage, color = stage)) +
geom_point() +
geom_smooth(method = "lm", se = FALSE) +
theme_minimal()
# Relação entre NBLS e produtividade
ggplot(CERC_PROTH_data, aes(NBLS, kg_ha, group = stage, color = stage)) +
geom_point() +
geom_smooth(method = "lm", se = FALSE) +
theme_minimal()
ggplot(CERC_PROTH_data, aes(x= pressure, kg_ha, group = pressure)) +
geom_boxplot()
mix_yld  <- lmer(kg_ha ~ 1 + ( 1 | blk), data=CERC_PROTH_data, REML=F)
mix_yld1 <- lmer(kg_ha ~ pressure + (pressure | blk), data=CERC_PROTH_data, REML=F)
mix_yld2 <- lmer(kg_ha ~ pressure + (1 | pressure), data=CERC_PROTH_data, REML=F)
mix_yld3 <- lmer(kg_ha ~ pressure + (1 | blk), data=CERC_PROTH_data, REML=F)
mix_yld4 <- lmer(kg_ha ~ pressure + (1 | trt/blk), data=CERC_PROTH_data, REML=F)
mix_yld5 <- lmer(kg_ha ~ pressure * rate * (1 | trt/blk), data=CERC_PROTH_data, REML=F)
mix_yld6 <- lmer(kg_ha ~ pressure * rate * (1 | pressure/blk), data=CERC_PROTH_data, REML=F)
mix_yld7 <- lmer(kg_ha ~ rate * (1 | trt/blk), data=CERC_PROTH_data, REML=F)
AIC(mix_yld, mix_yld1, mix_yld2, mix_yld3, mix_yld4, mix_yld5, mix_yld6, mix_yld7)
BIC(mix_yld, mix_yld1, mix_yld2, mix_yld3, mix_yld4, mix_yld5, mix_yld6, mix_yld7)
anova(mix_yld5, mix_yld6)
summary(mix_yld5)
summary(mix_yld6)
summary(mix_yld7)
YLD_emm_kg <- emmeans(mix_yld5, ~ rate * pressure)
print(cld(YLD_emm_kg, alpha = 0.05, Letters = letters))
